end to end spark script